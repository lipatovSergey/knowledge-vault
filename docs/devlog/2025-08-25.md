## 2025-08-25 â€” Initialize DB before importing app (session middleware fix)

**Feature goal:**  
Ensure that the session middleware reuses the same Mongoose client instead of opening a separate connection. This avoids redundant traffic and keeps connection handling clean.

**Contract:**  
- DB: `connectDB()` must complete before Express app is loaded.  
- Middleware: `sessionMiddleware` checks if a Mongoose connection already exists; if not, it opens a new client.  
- Fix: delay `require("./app")` until after `connectDB` succeeds.

### Development steps
1. **Initial approach (problematic):**
   ```js
   const app = require("./app");
   connectDB()
     .then(() => {
       app.listen(PORT, () => {
         console.log(`Server running on port ${PORT}`);
       });
     });
	```

* Problem: `app` (and `sessionMiddleware`) is imported before DB connection is established.
* Result: session middleware cannot reuse the Mongoose client and spins up its own, leading to duplicate clients and unnecessary traffic.

2. **Updated approach (fixed):**
   ```js
   connectDB()
     .then(() => {
       const app = require("./app");
       app.listen(PORT, () => {
         console.log(`Server running on port ${PORT}`);
       });
     })
     .catch((error) => {
       console.error("MongoDB connection error", error);
     });
   ```

   * Solution: require `app` only after a successful DB connection.
   * Now `sessionMiddleware` sees an existing Mongoose connection and reuses it.

### Result

* Single MongoDB client is used across both app and session store.
* Cleaner startup flow: app loads only after DB is ready.
* Avoids redundant connections and extra traffic.
